---
- hosts: localhost
  gather_facts: False
  vars:
    private_network_name: private
    private_subnet_name: "{{ private_network_name }}-subnet"
    router_name: "router1"
    webserver_name: "web-server"
    mqttbroker_name: "mqtt-broker"
  tasks:
  - name: Authenticate as project admin
    os_auth:
      cloud: project_admin
  - name: Delete instance "{{ webserver_name }}"
    os_server:
      cloud: project_admin
      state: absent
      name: "{{ webserver_name }}"
  - name: Delete instance "{{ mqttbroker_name }}"
    os_server:
      cloud: project_admin
      state: absent
      name: "{{ mqttbroker_name }}"
  - name: Delete router "{{ router_name }}"
    os_router:
      cloud: project_admin
      state: absent
      name: "{{ router_name }}"
  - name: Delete subnet "{{ private_subnet_name }}"
    os_subnet:
      cloud: project_admin
      state: absent
      name: "{{ private_subnet_name }}"
  - name: Delete network "{{ private_network_name }}"
    os_network:
      cloud: project_admin
      state: absent
      name: "{{ private_network_name }}"
